{% extends "base.html" %}

{% block content %}
	<div class="row map">
		<div class="span2">
			<a href="#" class="map_hide">[hide map]</a>
		</div>
		<div class="span8">
			<div class="map" id="map_canvas" style="width: 100%; height: 350px"></div>
		</div>
	</div>

	<div id="events"></div>

	<script src="//maps.googleapis.com/maps/api/js?key={{ settings.GOOGLE_API_KEY }}&amp;sensor=false" type="text/javascript"></script>

	<script src="/static/js/site.js" type="text/javascript"></script>

	<script type="text/javascript">
	$(function() {
		var myOptions = {
			center: new google.maps.LatLng({{ pos }}),
			zoom: 14,
			mapTypeId: google.maps.MapTypeId.ROADMAP
		};

		map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

		refresh_map({{ pos }});

		google.maps.event.addListener(map, 'click', function(e) {
			refresh_map(e.latLng.lat(), e.latLng.lng());
		});

		{% if autoset %}
		if(navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(function (l) {
				refresh_map(l.coords.latitude, l.coords.longitude);
			})
		}
		{% endif %}
	});
	</script>

{% endblock %}
