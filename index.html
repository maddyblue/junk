
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Matt Jibson's Blog</title>
  <meta name="author" content="Matt Jibson">

  
  <meta name="description" content="Previously we have discussed our reasoning and API for localization. Here, we would like to continue with the next topic: text extraction from the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mjibson.github.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Matt Jibson's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26568697-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Matt Jibson's Blog</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mjibson.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/01/careers-localization-part-3-extraction/">Careers Localization, part 3: Extraction with Roslyn and Uglify</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-01T15:52:00-07:00" pubdate data-updated="true">Mar 1<span>st</span>, 2013</time>
        
         | <a href="/blog/2013/03/01/careers-localization-part-3-extraction/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="/blog/2013/02/28/careers-localization-part-2-api/">Previously</a> we have discussed our reasoning and API for localization. Here, we would like to continue with the next topic: <strong>text extraction from the source code</strong>. That is, after we have indicated the text we would like translated, how we extract that text out of our codebase for translation. (Note: we used <a href="http://www.acclaro.com/">Acclaro</a> for the actual translation, and have been very happy with them. Recommended.)</p>

<p>The difficulty is to extract all of the strings so that they can be sent to translators. Compounding this difficulty, we also must make sure to send the correct number of <strong>plural forms</strong> to the translators. Look at the example below. <code>__count</code> does not appear in the translated string, only in the values object. This means we must, at extraction time, understand these value objects and be able to reason about them&#8212;we must know their types.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="n">_s</span><span class="p">(</span><span class="s">&quot;There is a unicorn&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">__count</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">})</span> <span class="c1">// &quot;There are some unicorns&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>There are a few bad ways to do this:</p>

<ul>
<li>build a parser by hand to deal with this (possible, but fragile, error-prone, and silently oblivious to things it does not support)</li>
<li>search or grep</li>
<li><a href="http://stackoverflow.com/a/1732454/864236">regex</a></li>
</ul>


<p>Our first solution was the hand-built parser. It worked reasonbly well, but there were known, unfixable bugs. We needed a solution that allowed us to have full syntatic and semantic understanding of source code files. Syntax for knowing the tree of the source code: function calls, argument lists, object access. Semantic for seeing into object types and values.</p>

<h2>C# and Razor extraction with Roslyn</h2>

<p>The C# team at Microsoft has been working on a project called <a href="http://msdn.microsoft.com/en-us/vstudio/roslyn.aspx">Roslyn</a>. It is a programmatic way to access the syntax tree and semantic model of C# files. That means that we can hand it a C# file and then search through it looking for certain kinds of things, and act on them. Roslyn comes with a SyntaxWalker class that walks over each node. You can override the one you want. In our case, we want any invocation (function call) named <code>_s</code> or <code>_m</code>:</p>

<figure class='code'><figcaption><span>C#</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="k">private</span> <span class="k">static</span> <span class="n">readonly</span> <span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">SINGLE_LINE</span> <span class="o">=</span> <span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;_s&quot;</span><span class="p">,</span> <span class="s">&quot;_m&quot;</span> <span class="p">};</span>
</span><span class='line'><span class="k">public</span> <span class="n">override</span> <span class="kt">void</span> <span class="n">VisitInvocationExpression</span><span class="p">(</span><span class="n">InvocationExpressionSyntax</span> <span class="n">node</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">base</span><span class="p">.</span><span class="n">VisitInvocationExpression</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</span><span class='line'>  <span class="n">var</span> <span class="n">callname</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">Expression</span><span class="p">.</span><span class="n">GetText</span><span class="p">().</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">SINGLE_LINE</span><span class="p">.</span><span class="n">Any</span><span class="p">(</span><span class="n">callname</span><span class="p">.</span><span class="n">EndsWith</span><span class="p">))</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">var</span> <span class="n">stringInfo</span> <span class="o">=</span> <span class="n">StringInfo</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">ArgumentList</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">stringInfo</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
</span><span class='line'>          <span class="c1">// save it somewhere</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we&#8217;re trying to create a new <code>StringInfo</code> (just a container class). We need to examine our <code>node.ArgumentList</code> and see if the first argument is a string. We use C#&#8217;s dynamic feature coupled with various ways to call <code>StringInfo.Create</code> to easily support different types of arguments (noted in comments above the functions):</p>

<figure class='code'><figcaption><span>C#</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="c1">// _s(&quot;string&quot;, object) (object may contain __count)</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="n">StringInfo</span> <span class="n">Create</span><span class="p">(</span><span class="n">ArgumentListSyntax</span> <span class="n">args</span><span class="p">,</span> <span class="n">ISemanticModel</span> <span class="n">model</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">var</span> <span class="n">first</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">Arguments</span><span class="p">.</span><span class="n">FirstOrDefault</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">first</span> <span class="o">==</span> <span class="n">null</span> <span class="o">||</span> <span class="n">first</span><span class="p">.</span><span class="n">Expression</span><span class="p">.</span><span class="n">Kind</span> <span class="o">!=</span> <span class="n">SyntaxKind</span><span class="p">.</span><span class="n">StringLiteralExpression</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">null</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">var</span> <span class="n">stringInfo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringInfo</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">Text</span> <span class="o">=</span> <span class="n">first</span><span class="p">.</span><span class="n">Expression</span><span class="p">.</span><span class="n">GetFirstToken</span><span class="p">().</span><span class="n">ValueText</span><span class="p">,</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">var</span> <span class="n">second</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Skip</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">second</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
</span><span class='line'>      <span class="n">stringInfo</span><span class="p">.</span><span class="n">Count</span> <span class="o">=</span> <span class="n">HasCount</span><span class="p">((</span><span class="n">dynamic</span><span class="p">)</span><span class="n">second</span><span class="p">.</span><span class="n">Expression</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="n">stringInfo</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// _s(&quot;string only&quot;) (no object, no __count)</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="n">StringInfo</span> <span class="n">Create</span><span class="p">(</span><span class="n">LiteralExpressionSyntax</span> <span class="n">literal</span><span class="p">,</span> <span class="n">ISemanticModel</span> <span class="n">model</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">literal</span> <span class="o">==</span> <span class="n">null</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">null</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="k">new</span> <span class="n">StringInfo</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">Text</span> <span class="o">=</span> <span class="n">literal</span><span class="p">.</span><span class="n">Token</span><span class="p">.</span><span class="n">ValueText</span><span class="p">,</span>
</span><span class='line'>      <span class="n">Count</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ok, now we&#8217;ve got our string. Next we need to figure out if <code>__count</code> is part of the object. We&#8217;ve implemented various ways to determine <code>HasCount()</code>, as referenced above on line 14. Again, C#&#8217;s dynamic proves useful.</p>

<figure class='code'><figcaption><span>C#</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="k">private</span> <span class="k">const</span> <span class="n">string</span> <span class="n">COUNT</span> <span class="o">=</span> <span class="s">&quot;__count&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// _s(&quot;string&quot;, new { __count = 1 })</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">HasCount</span><span class="p">(</span><span class="n">AnonymousObjectCreationExpressionSyntax</span> <span class="n">arg</span><span class="p">,</span> <span class="n">ISemanticModel</span> <span class="n">model</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">var</span> <span class="n">result</span> <span class="o">=</span> <span class="n">arg</span><span class="p">.</span><span class="n">Initializers</span><span class="p">.</span><span class="n">Any</span><span class="p">(</span><span class="n">x</span> <span class="o">=&gt;</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">NameEquals</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
</span><span class='line'>              <span class="k">return</span> <span class="n">x</span><span class="p">.</span><span class="n">NameEquals</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">Identifier</span><span class="p">.</span><span class="n">ValueText</span> <span class="o">==</span> <span class="n">COUNT</span><span class="p">;</span> <span class="c1">// see if __count is part of the object</span>
</span><span class='line'>          <span class="k">return</span> <span class="n">HasCount</span><span class="p">((</span><span class="n">dynamic</span><span class="p">)</span><span class="n">x</span><span class="p">.</span><span class="n">Expression</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span> <span class="c1">// otherwise throw it back</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// _s(&quot;string&quot;, obj)</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">HasCount</span><span class="p">(</span><span class="n">IdentifierNameSyntax</span> <span class="n">arg</span><span class="p">,</span> <span class="n">ISemanticModel</span> <span class="n">model</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c1">// we already have an object, just see if it has __count</span>
</span><span class='line'>  <span class="n">var</span> <span class="n">symbols</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">LookupSymbols</span><span class="p">(</span><span class="n">arg</span><span class="p">.</span><span class="n">Span</span><span class="p">.</span><span class="n">Start</span><span class="p">,</span> <span class="nl">name:</span> <span class="n">arg</span><span class="p">.</span><span class="n">Identifier</span><span class="p">.</span><span class="n">ValueText</span><span class="p">);</span>
</span><span class='line'>  <span class="n">var</span> <span class="n">first</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">.</span><span class="n">First</span><span class="p">();</span>
</span><span class='line'>  <span class="n">TypeSymbol</span> <span class="n">type</span> <span class="o">=</span> <span class="p">((</span><span class="n">dynamic</span><span class="p">)</span><span class="n">first</span><span class="p">).</span><span class="n">Type</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">type</span><span class="p">.</span><span class="n">GetMembers</span><span class="p">(</span><span class="n">COUNT</span><span class="p">).</span><span class="n">Any</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// _s(&quot;string&quot;, obj.member)</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">HasCount</span><span class="p">(</span><span class="n">MemberAccessExpressionSyntax</span> <span class="n">arg</span><span class="p">,</span> <span class="n">ISemanticModel</span> <span class="n">model</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c1">// extract out member...</span>
</span><span class='line'>  <span class="n">var</span> <span class="n">name</span> <span class="o">=</span> <span class="n">arg</span><span class="p">.</span><span class="n">Expression</span> <span class="n">as</span> <span class="n">IdentifierNameSyntax</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
</span><span class='line'>      <span class="c1">// ...and try some of our above functions</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">HasCount</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// anything else</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">HasCount</span><span class="p">(</span><span class="n">ExpressionSyntax</span> <span class="n">arg</span><span class="p">,</span> <span class="n">ISemanticModel</span> <span class="n">model</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above tries all variants (that were in our code) that might contain <code>__count</code> somehow. The use of dynamic allows us to not care about the kind of expression, which is determined during runtime, and then the appropriate version of <code>HasCount()</code> is called. Here&#8217;s <a href="https://gist.github.com/mjibson/5052106#file-extractor-cs">a gist</a> of it all (it&#8217;s got some other features not listed here).</p>

<p>The above covers our C# controllers. For the Razor views, we cheat a bit. The ASP.NET compiler is invoked which converts the views into C# files, then the same extraction logic is run on those. This is much easier than trying to write a full razor parser.</p>

<h2>JavaScript extraction with UglifyJS</h2>

<p>For JavaScript, we use a similar technique. <a href="https://github.com/mishoo/UglifyJS">UglifyJS</a> is a JavaScript-based JavaScript parser. It also can return a syntax tree, which we can examine for uses of <code>_s</code>, from which we can extract strings and objects. It&#8217;s a pretty hideous function and not worth pasting, but <a href="https://gist.github.com/mjibson/5052106#file-extractor-js">here it is</a>.</p>

<p>Both of these extractors yield JSON, which is processed in node and sent off to our translation service. We also have a dashboard (built with <a href="http://angularjs.org/">AngularJS</a>) to view all translations, fix them, and reprocess all the files.</p>

<h2>Conclusion</h2>

<p>Having two full language parsers allows us to be flexible. Both our C# and JavaScript implementations are equally functional at all levels&#8212;API, extraction, display&#8212;allowing us to have one unified API in our codebase.</p>

<p>Translation and localization are hard. We spent months refactoring and extending our codebase to support it. But now, we can change, add, and translate strings with little effort, because our tools handle all the hard stuff. If you care about having quality translations (supporting dynamic text insertion and pluralization), whichever solution you use (resource files or gettext-style) must be able to fully understand your code so that it can generate high-quality output to send to translators.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/28/careers-localization-part-2-api/">Careers Localization, part 2: The API</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-28T15:52:00-07:00" pubdate data-updated="true">Feb 28<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/28/careers-localization-part-2-api/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="/blog/2013/02/27/careers-localization-part-1-why-roll-our-own/">Previously</a> we discussed our design requirements and solution for localization. Here we will continue with a description of the API. This means the way in which we would craft strings to be localized.</p>

<h2>Markup</h2>

<p>We chose to use gettext-style translation strings (i.e., not resource files where strings are identified somehow, instead we just indicate the English string right where it will be shown). We chose a syntax that allows dynamic variable replacement and easy pluralization, and can work similarly in JavaScript and C#. Here&#8217;s what we came up with:</p>

<figure class='code'><figcaption><span>C#</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="n">_s</span><span class="p">(</span><span class="s">&quot;Unicorns prance&quot;</span><span class="p">)</span> <span class="c1">// &quot;Unicorns prance&quot;</span>
</span><span class='line'><span class="n">_s</span><span class="p">(</span><span class="s">&quot;$name$ have horns&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Unicorns&quot;</span> <span class="p">})</span> <span class="c1">// &quot;Unicorns have horns&quot;</span>
</span><span class='line'><span class="n">_s</span><span class="p">(</span><span class="s">&quot;There are $__count$ unicorns&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">__count</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">})</span> <span class="c1">// &quot;There is 1 unicorn&quot;</span>
</span><span class='line'><span class="n">_s</span><span class="p">(</span><span class="s">&quot;There is a unicorn&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">__count</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">})</span> <span class="c1">// &quot;There are some unicorns&quot;</span>
</span><span class='line'><span class="n">_s</span><span class="p">(</span><span class="err">@</span><span class="s">&quot;</span>
</span><span class='line'>  <span class="n">Multi</span>
</span><span class='line'>  <span class="n">line</span>
</span><span class='line'>  <span class="n">supported</span><span class="p">.</span><span class="s">&quot;) // &quot;</span><span class="n">Multi</span> <span class="n">line</span> <span class="n">supported</span><span class="p">.</span><span class="s">&quot; (whitespace collapsed)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>JavaScript</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">_s</span><span class="p">(</span><span class="s1">&#39;Unicorns prance&#39;</span><span class="p">)</span> <span class="c1">// &quot;Unicorns prance&quot; (single or double quotes accepted - any valid JavaScript string)</span>
</span><span class='line'><span class="nx">_s</span><span class="p">(</span><span class="s2">&quot;$name$ have horns&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Unicorns&quot;</span> <span class="p">})</span> <span class="c1">// &quot;Unicorns have horns&quot;</span>
</span><span class='line'><span class="nx">_s</span><span class="p">(</span><span class="s1">&#39;There are $__count$ unicorns&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">__count</span><span class="o">:</span> <span class="mi">1</span> <span class="p">})</span> <span class="c1">// &quot;There is 1 unicorn&quot;</span>
</span><span class='line'><span class="nx">_s</span><span class="p">(</span><span class="s2">&quot;There is a unicorn&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">__count</span><span class="o">:</span> <span class="mi">3</span> <span class="p">})</span> <span class="c1">// &quot;There are some unicorns&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We chose a function named <code>_s</code> that takes a string and an optional values object used for variable replacement. There is a special <code>__count</code> member of the values object which, if it exists, indicates to our translation engine that this is a pluralizeable string. Calls to <code>_s</code> could be in our C# files anywhere in the tree. They could also be in our razor views:</p>

<figure class='code'><figcaption><span>Razor</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="err">@</span><span class="n">_s</span><span class="p">(</span><span class="s">&quot;translate this&quot;</span><span class="p">)</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, it also supports existing objects:</p>

<figure class='code'><figcaption><span>C#</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="k">class</span> <span class="nc">User</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">public</span> <span class="n">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="n">get</span><span class="p">;</span> <span class="n">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">var</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span> <span class="p">{</span> <span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;Jimmy the Unicorn&quot;</span> <span class="p">};</span>
</span><span class='line'><span class="n">_s</span><span class="p">(</span><span class="s">&quot;$Name$ is here!&quot;</span><span class="p">,</span> <span class="n">user</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Markdown</h2>

<p>Requirement 5 from part 1 is to support markdown formatting. The purpose of this requirement was so that we would never send HTML to translators. We do not trust someone else writing our HTML. Thus, we needed support for simplified markdown (only bold, italics, and links). Out of this grew the <code>_m</code> function (m for markdown, in contrast to s for string in <code>_s</code>). This puts certain tweets in perspective.</p>

<blockquote><p>And so begins the drive to redefine &#8220;S&M&#8221; in the company lexicon.</p><footer><strong>@kevinmontrose</strong> <cite><a href='https://twitter.com/kevinmontrose/status/233392144193294336'>twitter.com/kevinmontrose/&hellip;</a></cite></footer></blockquote>


<p>With <code>_m</code>, we can do things like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="n">_m</span><span class="p">(</span><span class="s">&quot;Hi, **we hate fun** here at [stack overflow](stackoverflow.com).&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Limitations</h2>

<p>The above API has some problems, or doesn&#8217;t support the following cases:</p>

<h3>Best-practice DOM handling</h3>

<p>Due to the use of markdown instead of HTML, there are some annoyances about how we must treat DOM elements. Let&#8217;s say that, before translation, we had something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span><span class="n">Hello</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;click&quot;</span><span class="o">&gt;</span><span class="n">click</span> <span class="n">here</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="k">for</span> <span class="n">magic</span><span class="p">.</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="err">$</span><span class="p">(</span><span class="s">&quot;#click&quot;</span><span class="p">).</span><span class="n">click</span><span class="p">(</span><span class="n">cb</span><span class="p">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>In (incorrect) translated form, we would have this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span><span class="err">@</span><span class="n">_s</span><span class="p">(</span><span class="s">&quot;Hello,&quot;</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;click&quot;</span><span class="o">&gt;</span><span class="err">@</span><span class="n">_s</span><span class="p">(</span><span class="s">&quot;click here&quot;</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="err">@</span><span class="n">_s</span><span class="p">(</span><span class="s">&quot;for magic.&quot;</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is incorrect because the sentence has now been fragmented into three. Translators will then get these three fragments and must translate each on its own, with no power to reorder them if needed in the target language. But, how can we retain the JavaScript action? The <code>&lt;span&gt;</code> in there is not supported since we don&#8217;t allow HTML in translated strings (or, more accurately, we encode all output strings so they are HTML-safe). The solution is to use our markdown formatting and do funky stuff with the DOM. In markdown, we have access to <code>&lt;strong&gt;</code> and <code>&lt;em&gt;</code>, thus:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;click&quot;</span><span class="o">&gt;</span><span class="err">@</span><span class="n">_m</span><span class="p">(</span><span class="s">&quot;Hello, **click here** for magic.&quot;</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="err">$</span><span class="p">(</span><span class="s">&quot;#click strong&quot;</span><span class="p">).</span><span class="n">click</span><span class="p">(</span><span class="n">cb</span><span class="p">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>**click here**</code> will render as <code>&lt;strong&gt;click here&lt;/strong&gt;</code>, which we can use in a selector. You must then also apply CSS to disable the normal bolding. Annoying, but it works.</p>

<h3>Gender variants</h3>

<p>Some languages vary articles by the gender (or pluralization) of its object. This is difficult to do because sometimes we don&#8217;t know the gender, and so it&#8217;s impossible to tell the translation engine which gender to use. Consider:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="n">_s</span><span class="p">(</span><span class="s">&quot;I&#39;m going to $location$.&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">location</span> <span class="o">=</span> <span class="s">&quot;Brazil&quot;</span> <span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>In Portuguese, &#8220;to&#8221; varies based on <code>$location$</code>. We need to know the gender and pluralization of <code>$location$</code> (for example, the United States is masculine plural, and so &#8220;to&#8221; would change to &#8220;aos&#8221;). But we allow any location to be entered, so we would have to have that data for each of our target languages for all (or at least many) possible places. We&#8217;re not sure where to get that data, so we&#8217;re not supporting this yet.</p>

<h3>Multiple pluralized words</h3>

<p>We support exactly one <code>__count</code> instance, which means you can&#8217;t have two pluralized words in a sentence. Let&#8217;s consider the following case, assuming we wish to support any number of pluralizable words:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="n">_s</span><span class="p">(</span><span class="s">&quot;I have $count1$ rainbows and $count2$ pandas.&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">count1</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">count2</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>English, German, French (and many others) have two plural forms (singular and other). This means we would have to generate <code>2 ^ 2 = 4</code> combinations of sentences to be pluralized:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="mi">1</span> <span class="n">rainbow</span> <span class="n">and</span> <span class="mi">1</span> <span class="n">panda</span><span class="p">.</span>
</span><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="mi">1</span> <span class="n">rainbow</span> <span class="n">and</span> <span class="n">N</span> <span class="n">pandas</span><span class="p">.</span>
</span><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="n">N</span> <span class="n">rainbows</span> <span class="n">and</span> <span class="mi">1</span> <span class="n">panda</span><span class="p">.</span>
</span><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="n">N</span> <span class="n">rainbows</span> <span class="n">and</span> <span class="n">N</span> <span class="n">pandas</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>There are languages that have <a href="http://unicode.org/repos/cldr-tmp/trunk/diff/supplemental/language_plural_rules.html">up to six</a> plural forms: zero, one, two, few, many, other. So, for the above example string, we would have to generate <code>6 ^ 2 = 36</code> combinations:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="mi">0</span> <span class="n">rainbows</span> <span class="n">and</span> <span class="mi">0</span> <span class="n">pandas</span><span class="p">.</span>
</span><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="mi">1</span> <span class="n">rainbows</span> <span class="n">and</span> <span class="mi">0</span> <span class="n">pandas</span><span class="p">.</span>
</span><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="mi">2</span> <span class="n">rainbows</span> <span class="n">and</span> <span class="mi">0</span> <span class="n">pandas</span><span class="p">.</span>
</span><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="n">few</span> <span class="n">rainbows</span> <span class="n">and</span> <span class="mi">0</span> <span class="n">pandas</span><span class="p">.</span>
</span><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="n">many</span> <span class="n">rainbows</span> <span class="n">and</span> <span class="mi">0</span> <span class="n">pandas</span><span class="p">.</span>
</span><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="n">other</span> <span class="n">rainbows</span> <span class="n">and</span> <span class="mi">0</span> <span class="n">pandas</span><span class="p">.</span>
</span><span class='line'><span class="c1">// Etc., with all combinations:</span>
</span><span class='line'><span class="n">I</span> <span class="n">have</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">few</span><span class="p">,</span> <span class="n">many</span><span class="p">,</span> <span class="n">other</span><span class="p">]</span> <span class="n">rainbows</span> <span class="n">and</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">few</span><span class="p">,</span> <span class="n">many</span><span class="p">,</span> <span class="n">other</span><span class="p">]</span> <span class="n">pandas</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>These must all be generated for translation because it is possible that in the target language, the surrounding words could change. For instance, maybe &#8220;have&#8221; changes based on the object, instead of the subject, as in English. Due to this complication, we capped pluralization at one item per string.</p>

<h3>Other things we don&#8217;t know about</h3>

<p>There are many languages, and we&#8217;re sure some of them have constructs that the above API doesn&#8217;t support at all.</p>

<h2>Conclusion</h2>

<p>The API allows us to do almost everything we need. The limitations ended up being truly limiting in only a few cases, and those could be worked around be restructuring the sentence. The next problem: how do we actually find the usages of <code>_s</code> and send them off to translators?</p>

<p><a href="/blog/2013/03/01/careers-localization-part-3-extraction/">Part 3: Extraction</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/27/careers-localization-part-1-why-roll-our-own/">Careers Localization, part 1: Why Roll Our Own?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-27T15:52:00-07:00" pubdate data-updated="true">Feb 27<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/27/careers-localization-part-1-why-roll-our-own/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Localization is a difficult feature to add to a website. A few months ago, we at <a href="http://careers.stackoverflow.com/">Stack Overflow Careers</a> localized into <a href="http://careers.stackoverflow.com/de/">German</a>. This took months of effort from much of the team. I would like to describe our design and implementation over a few blog posts.</p>

<p>This post will discuss our design choices.</p>

<h2>Requirements</h2>

<p>Localization consists of</p>

<ol>
<li>indicating text that should be localized</li>
<li>translating it</li>
<li>showing the correct translation to the user</li>
</ol>


<p>There are various existing solutions in most programming languages that can do this. We looked at some, but none were able to meet all of our design and support requirements:</p>

<ol>
<li>C#</li>
<li>JavaScript</li>
<li>Razor views</li>
<li>data attributes for localized error messages on form validation</li>
<li>markdown formatting (so that no HTML is ever sent to translators)</li>
<li>dynamic text replacement</li>
<li>pluralization-aware</li>
<li>gettext-style (English text in a function - no resource files and identifiers)</li>
</ol>


<p>We discussed some of these requirements with others who had previously localized their sites. Some had decided to forfeit features due to difficulty of implementation (pluralization, dynamic text). Supporting each of these requirements is difficult, so we understood the decision to omit them. However, we were not willing to do the same.</p>

<h2>Our Solution</h2>

<p>The other solutions missed some our of requirements, or functioned in a way we didn&#8217;t like. We were, however, heavily influenced by existing work, like that of <a href="https://github.com/danielcrenna/i18n">Daniel Crenna</a>. We have a long history of rolling our own software when the 90% solution isn&#8217;t enough, and that tradition was continued here. We ended up writing the entire implementation from scratch. This includes designing an API, extraction process (to determine what strings the translators should translate), and localization engine to support numbers, dates, and translated strings. This allowed us to have a unified pipeline for text extraction and processing (i.e., the C# and JavaScript implementations could be identical at each step of the process), and give us the power and speed we wanted in the implementation.</p>

<p>As will be described in future posts, our implementation met all of our requirements, but with some limitations. Localization is hard, and doing everything is near impossible. If we wanted something better than the 90% solution, then what we have now is maybe in the 95% range: there are still missing features that we haven&#8217;t figured out yet.</p>

<p><a href="/blog/2013/02/28/careers-localization-part-2-api/">Part 2: The API</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/05/appstats-for-go/">Appstats for Go</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-05T01:56:00-07:00" pubdate data-updated="true">Feb 5<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/05/appstats-for-go/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I would like to announce the release of appstats for go. Installation instructions are <a href="http://godoc.org/github.com/mjibson/appstats">available on godoc.org</a>. I&#8217;d like to thank Dave Symonds for <a href="https://groups.google.com/forum/?fromgroups=#!topic/google-appengine-go/laOsfI1dSGY">his help</a> on this project.</p>

<p>A <a href="http://schalmei-go.appspot.com/">demo site</a> is available.</p>

<p><a href="/assets/images/appstats-timeline.png"><img src="/assets/images/appstats-timeline.png"></a></p>

<p><a href="https://developers.google.com/appengine/docs/python/tools/appstats">Appstats</a> is an incredibly useful library for the python (and java) runtimes. The go runtime has had no similar library, adding to the difficulty of developing significant apps. I&#8217;d like to describe a bit about how appstats is implemented (applies to python, as well) and where I think the go runtime is today.</p>

<h2>implementation</h2>

<p>Appstats for go was implemented by copying the python HTML templates, examining the source, and attempting to make something work in go.</p>

<h3>intercepting the data</h3>

<p>In order for appstats to work pleasantly, it needs to automatically populate data from the HTTP request and intercept all RPC calls to app engine&#8217;s services (datastore, memcache, etc.). This is done by a wrapper that provides an <code>appengine.Context</code> instance to a handler function. Both the <code>http.ResponseWriter</code> and <code>appengine.Context</code> variables are actually appstats structs that forward importart calls and record timings and data. Go routines are fully supported: all of the internals are thread-safe, and appstats waits for all RPC calls to complete before serializing and saving its data.</p>

<h3>persist to memcache</h3>

<p>I had always wondered how python appstats stored its data. It was obviously in memcache, but it was interesting how it was able to so quickly store so many requests and fetch them all. How did that work? The timestamp on a request (well, just <code>time.Now()</code> when appstats starts) is used. The current count of microseconds is the memcache key to a request. If it overwrites another request, that&#8217;s ok. For example, a request that happened at <code>04:10:40.40567</code> gets the key <code>40500</code>. The final two digits are converted to 0 so that we can limit the number of keys to 1000. Then, to fetch them all, appstats generates all 1000 possible keys and requests them from memcache. Only existing keys are returned. Each request stores a partial (for the index dashboard) and full (for the details page) item in memcache, with the type (&#8220;part&#8221; or &#8220;full&#8221;) appended to the key name.</p>

<h3>things it doesn&#8217;t have</h3>

<p>There are a few things that python appstats does that this implementation does not (yet). Some may not be possible ever, and some may require Google to help us out a bit:</p>

<ul>
<li>full RPC cost information (only writes cost, currently; reads and small ops not yet implemented)</li>
<li>stack traces with variables and values at each stack frame</li>
<li>protobuf examination for better details (in the &#8220;Response&#8221; and &#8220;Request&#8221; lines of each RPC call on the details page)</li>
</ul>


<h2>today&#8217;s app engine go runtime</h2>

<p>The two killer features of the python runtime on app engine are NDB and appstats. I have been refusing to make a serious app with the go runtime because of this lack. To address those concerns, I have created <a href="https://github.com/mjibson/goon">goon</a> (an NDB-like library for go) and appstats. With the addition of these two libraries, I believe <strong>the go runtime can now compete with python</strong>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/10/job-offers-are-not-demands/">Job offers are not demands</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-10T22:13:00-07:00" pubdate data-updated="true">Jan 10<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/01/10/job-offers-are-not-demands/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I am contacted around once per week by people interested in hiring me. Usually email, sometimes on <a href="http://careers.stackoverflow.com">Careers</a>, even phone calls. I don&#8217;t think I&#8217;ve ever responded to these. This is not because I&#8217;m against this kind of recruiting, it&#8217;s because I haven&#8217;t been persuaded in the least by these offers. My <a href="http://careers.stackoverflow.com/mjibson">careers profile</a> even lists me as &#8220;Passive candidate interested in full-time position.&#8221;. That means I have a job, but if you have a better one, maybe I&#8217;ll take it. No one has even piqued my interest, so far. The job offers here (well, not offers, but I&#8217;m not sure of a better term) tell me all about the company and the job, but nothing about how my life will be better there.</p>

<p>Let&#8217;s make one up and look it it:</p>

<h2>Software Developer at Fun Startup!</h2>

<p>We&#8217;re a great funded startup with a small and growing team looking to hire the best. We have fun, work on hard problems, and love exciting technologies. You&#8217;ll own large portions of the code and have the freedom to work how you want.</p>

<h4>Skills</h4>

<p>Experience in MVC-based technologies and databases
&#8230;And many other things</p>

<h4>About Us</h4>

<p>We are fun people and awesome. We offer good salaries and benefits.</p>

<h2>Attraction</h2>

<p>The above is about 90% of all the job offers I see, and I will never respond to them. Nowhere in it do they <strong>entice me to work for them</strong>. So many places already offer the same things: startup, small, growing, fun technologies, good salary. I want to see something better than those. What&#8217;s worse, the only list there is a <strong>list of demands</strong> about what I must have. Where is the list of things you&#8217;ll give me? There&#8217;s multiple descriptions of skills I must have, and none about why I should provide those skills to you. I don&#8217;t like job offers that sound like they&#8217;re scrutinizing me. I want something that dazzles me.</p>

<p>For example, a few months ago I was contacted by a company on Careers. I responded not interested. I received a message back asking why. I said: &#8220;I love my current job. Your message didn&#8217;t convince me that I&#8217;d be happier at your company than I am at mine&#8221;. The response was so interesting: <strong> &#8220;can you truly get the sense of what a company is all about from an e-mail message?&#8221;</strong> Fixing that idea is the purpose of this blog post. Here was my final message:</p>

<hr />

<p>I think that is possible to a large degree. For example, my company is also hiring. <a href="http://careers.stackoverflow.com/jobs/28723/web-developer-stack-exchange-stack-exchange">Here&#8217;s</a> our job post.</p>

<p>The benefits list is of such high quality that unless I see such a list on another job post, I&#8217;m not interested. I assume that if they had benefits this good, they would list them, since so few places do. The paragraph before the benefits list discusses the quality of the leadership and that they care deeply about making an awesome place to work. I read those two paragraphs alone and I don&#8217;t care about the rest of the job post, because I get a sense that they&#8217;ll treat me like a king, which they do.</p>

<p>The work descriptions of your message were great. I&#8217;m sure the work would be fun and satisfying, and that I would like working with the team. But without advertising the actual working conditions and how I&#8217;ll be treated beyond salary, it&#8217;s hard to switch.</p>

<h2>Conclusion</h2>

<p>If companies want to attract the best developers, they must publicly advertise <em>why</em> their job is better. Without that, no amount of &#8220;we&#8217;re awesome&#8221; talk is going to get anywhere.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/04/go-dsp-fft-performance-with-go-routines/">go-dsp FFT performance with go routines</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-04T03:30:00-07:00" pubdate data-updated="true">Jan 4<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/01/04/go-dsp-fft-performance-with-go-routines/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="https://github.com/mjibson/go-dsp">go-dsp</a> has been around for almost a year now. Recently I have been working on performance improvements. The low-hanging fruit was easy (removing duplicate calculations, smarter array copying, efficient data reordering with bit reversal). The difficult part was getting go routines to work as intended. That is, to have them improve the performance of go-dsp. This turned out to be more difficult than I expected.</p>

<h2>Why the fast Fourier Transform is parallelizable</h2>

<p><a href="http://en.wikipedia.org/wiki/File:DIT-FFT-butterfly.png"><img class="right" src="/assets/images/DIT-FFT-butterfly.png" width="300"></a></p>

<p>The FFT is paralellizable because of how the &#8220;fast&#8221; part is implemented. Given an input of length <code>L</code>, if there exist integers <code>M</code> and <code>N</code> such that <code>L = M * N</code>, then the original problem (one transform of size <code>L</code>) can be restated as <code>M</code> problems of size <code>N</code>. These <code>M</code> problems can be run in parallel. For example, say I have an input of size 8. I can reform this as 2 inputs of size 4. These 2 inputs can be run in parallel.</p>

<h2>Attempts</h2>

<p>Go&#8217;s easy support of go routines was the obvious solution here. I went through <a href="https://github.com/mjibson/go-dsp/tree/mp-test">a few solutions</a> until I found one that was <strong>not</strong> slower. What I discovered was that, although the FFT is highly parallelizable, setting up parallelization can easily take more time than it saves. The actual unit of work that is done is just multiplying two pairs of numbers and saving the result.</p>

<p>My first idea was to use wait groups. This involves a synchronized counter. One go routine is spun up per block (there are <code>M</code> blocks, as described above) and the counter incremented. The go routine decrements the counter when it is done. We wait until the counter is back to zero. Since the number of blocks varies from <code>2</code> to <code>L / 2</code>, this means that for about half of the time, so many go routines are spun up to do a very tiny amount of work that overall runtime increases. Ok, so, only do the wait group solution if it&#8217;ll actually be faster. I ran some tests and found out that (on my machine), if the block size is over 128, it&#8217;s worthwhile to spin up a new go routine. Remember that this solution was always using a single go routine when we were on smaller block sizes, ignoring any potential multicore speedup.</p>

<p>The second idea was to use worker pools. Since the main problem is the creation (not use) of go routines, spin up as many as we will need up front and then send work off to them. From testing I found that putting the number of workers at the value of <a href="http://golang.org/pkg/runtime/#GOMAXPROCS"><code>GOMAXPROCS</code></a> worked out well. Each worker&#8217;s job is to multiply the number pair described above. So, for each of the <code>n log n</code> iterations, we are sending off <code>L / 2</code> jobs. This ended up performing almost exactly as good as the above solution for larger block sizes, but had the added benefit of working with smaller block sizes, too. I guessed the reason for the lack of more speedup was the communication overhead. The jobs were sent using channels, which aren&#8217;t free.</p>

<p>The final solution addressed that problem by changing the number of jobs from <code>L / 2</code> to the block size (which, as a reminder, goes from <code>2</code> to <code>L / 2</code>). So only during one iteration are we sending the same number of jobs over. Almost always are we sending less. Previously, the jobs were specified by an index. This new solution instead specified a min and max index. The subsequent indicies are calculated in the worker itself. This results in much less channel overhead and distributes some work (index calculation) out to workers.</p>

<h2>Results</h2>

<p>The original, single-thread solution contains no multicore logic. It benchmarked at around 505ms. The graphs below show performance at <code>GOMAXPROCS = 6</code> and a FFT size of <code>2 ^ 20 = 1048576</code>.</p>

<p><img src="/assets/images/fftmp-1.png"></p>

<p>Above are results for the first two attempts. The blue line is the original, single-thread control. The green line shows the very poor performance at small block sizes. The red line shows similar performance as green for large block sizes but that it was able to handle smaller block sizes better (but still not great). Minimum runtime was 1.7x faster (267ms minimum).</p>

<p><img src="/assets/images/fftmp-2.png"></p>

<p>Here we see the final solution with indexed worker groups. Minimum runtime was 252ms (2.0x speedup). Not the 6x increase I wanted, but it&#8217;s not bad.</p>

<p>The final code (using the indexed worker group solution) is now <a href="https://github.com/mjibson/go-dsp">available</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/20/great-piano-pieces/">Great Piano Pieces</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-20T20:51:00-07:00" pubdate data-updated="true">Dec 20<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/12/20/great-piano-pieces/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have compiled some of my <a href="http://open.spotify.com/user/128346620/playlist/65QbOiGs3DuWa5I6a9MjXI">favorite piano recordings</a> on spotify. (Sorry rdio folks, I tried to make an equivalent playlist, but rdio doesn&#8217;t have some of the recordings I wanted and I couldn&#8217;t find suitable replacements.) Below are some short program notes.</p>

<h3>Ravel Piano Concerto 2</h3>

<p>One of the best overall. If I had to choose, the second movement is my favorite piano piece. I play it often, when I can. It is soft and meandering. The middle section&#8217;s intensity is a thrilling lift. Goose bumps come regurlarly while listening.</p>

<h3>Stravinsky Three Movements of Petrushka</h3>

<p>Originally a ballet for orchestra, he <a href="http://en.wikipedia.org/wiki/Trois_mouvements_de_Petrouchka">arranged it for piano</a> by request. I first heard this in 2004 at CSU for the opening of their new music hall. The excellent <a href="http://www.yakovkasman.com/">Yakov Kasman</a> performed and taught a master class. It was the first time I saw someone stand up during a piano solo due to his own intensity and interest in the piece. One of the most exciting and helpful performances I ever saw. I found a copy of the sheet music and was unable to play certain parts. (Being an orchestra original, it is for many instruments. The piano reduction is reduced to sometimes three staves. Having only two hands presents a problem. Somehow Mr. Kasman gets around that limitation.)</p>

<h3>John Adams Phrygian Gates</h3>

<p>A half-hour piece in a minimalist style. It starts simply enough with short phrases repeated many times over. The complexity and beauty increase throughout. Some people do not like minimalism. I feel about it the same as I feel about all music genres: the genre is unimportant, the quality of the sound is what makes it good. Phrygian Gates has many new ideas and sounds, many pleasing. This is why I enjoy it. But for those unfamiliar with minimalism: it has no melody and little harmony. The joy felt here is from understanding what is happening and the genuine feeling of pleasure when hearing something new and original (to me, this is the mark of a great composer).</p>

<h3>Prokofiev Piano Concerti 1, 2, 3</h3>

<p>The Russians are my favorite composers (and often performers; see above). Continuing on my last point about enjoying new sounds, Prokofiev was one of the most inventive composers. Although only a handful of years behind Rachmaninoff, Prokofiev was a century ahead in terms of originality. His concerti are my favorite compositions of his. Unlike Chopin (who was a poor arranger for orchestra, and thus produced piano concerti that are little more than excellent piano over orchestral chord changes), Prokofiev excelled at all voices of the orchestra. His concerti are thus more like duets between piano and orchestra, where each has an important part in the music. I have heard these concerti so many times they no longer sound dissonant. Instead I love hearing the chords because they are so new. My ears don&#8217;t hear things like this. The second concerto, although the least popular of the three, has some of the best rhythms and chords I&#8217;ve heard.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/16/success-by-selective-education/">Success by selective education</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-16T14:20:00-07:00" pubdate data-updated="true">Dec 16<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/12/16/success-by-selective-education/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Or: how to win by not studying</h2>

<p><a href="http://en.wikipedia.org/wiki/File:MOSFET_Structure.png"><img class="right" src="/assets/images/mosfet.png" width="300"></a></p>

<p>I once took a junior-level course in college about Metal-Oxide-Semiconductor Field-Effect Transistors. As part of the electrical engineering cirriculum, it was an important course. I had no interest whatsoever in the course, and to this day I&#8217;m still not sure what it was about. For example, I once showed up to class (I suspect my attendance was around or below 50%) to turn in a homework assignment and discovered that a midterm was scheduled for that day. I used the homework as the single sheet of notes we were allowed. I similarly neglected many of the courses I took.</p>

<p>I would like to describe here why I did that, my expectations about the future (due to that behavior), and what the future actually brought.</p>

<h2>Succumbing to laziness</h2>

<p>Some facts: In eight years of college, I ended up with two undergraduate degrees (music and computer engineering) and one Master&#8217;s degree (electrical engineering). In the six years of undergrad, I took some 220 credits (averaging 18 per semester). My GPA was around a 3.2 the entire time. During this time, I also wrote a lot of code. I worked on <a href="https://github.com/mjibson/ci">a game</a>, <a href="https://github.com/mjibson/iads-pygtk">a startup</a>, and <a href="https://github.com/mjibson/slammer">consulted</a>, some <a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/ports/print/lilypond/Makefile?rev=1.1;content-type=text%2Fplain">OpenBSD ports</a>.</p>

<p>I found that my grades were not related to the number of credits I was taking. Study time was not the limiting factor, interest was. What I wanted to do was program, and studying was a distraction. <strong>Programming is what I wanted to do, so I did it.</strong> Uninteresting classes just got in the way of writing software. I rarely studied for those classes (I don&#8217;t recall ever once reading any textbook unless it was to solve a specific homework problem), and passed with usually a C. Interesting classes were fun, so I worked on them (the fun kind of work) and generally got As or Bs. This was my standard: <strong>I&#8217;ll only work if I like it.</strong></p>

<h2>Impressions</h2>

<p><a href="http://en.wikipedia.org/wiki/File:Op-amp_symbol.svg"><img class="right" src="/assets/images/opamp.png" width="300"></a></p>

<p>At the time I felt that I was making mistakes and slacking off. I thought: instead of programming I should be studying for those other classes. I felt like I was messing myself up as an engineer since I was completely ignoring half of my major courses. For example, after 6 years of electrical engineering courses, I still didn&#8217;t know what an <a href="http://en.wikipedia.org/wiki/Operational_amplifier">op-amp</a> was, even though I had studied them in at least 4 courses. I was convinced that I was making bad choices. I was paying to go to school and not study. I was spending my time doing something that I didn&#8217;t plan on pursuing as a career (I wanted to design processors for Intel or AMD, not program full-time).</p>

<p>But even given this internal doubt, I still couldn&#8217;t bring myself to change. I just didn&#8217;t care about some of my courses, and I enjoyed making software so much that I wasn&#8217;t going to stop working on it to study.</p>

<h2>Results</h2>

<p>While finishing up my Master&#8217;s thesis, I had a great time writing the software to collect and process my lab data, and was totally bored by the actual thesis. It was sometime around there that I realized: I&#8217;m a software engineer, not an electrical engineer. All of my degrees pointed to EE, but my background, skills, and experience were strongly in the software camp.</p>

<p>Today I have a job at <a href="http://mattjibson.com/blog/2012/04/28/how-i-got-a-job-at-stack-overflow/">Stack Overflow</a>. Working here has been a dream for around 10 years. I consider myself supremely lucky to have met this major, personal goal. Now, I believe that I could not have gotten this job unless I pursued programming skills to the <strong>detriment of college achievement</strong>. If I had spent my time studying and working on those classes that I didn&#8217;t enjoy, I would not have had the time to work on software. I do not think I would have my current job if I had studied more instead of programming. I&#8217;m convinced that I&#8217;m happier and in a better job because of poor college performance than if I had excelled at college. I suspect in that case I would have a less interesting job doing something I&#8217;m less excited about.</p>

<h2>For others</h2>

<p>This is what worked for me. I wrote this blog post not to encourage students to slack off their course work, but to offer a real story. I was disappointed in myself for many years until my current job. I think there are some current students who have a similar outlook on their college career, and I wanted to offer this as a potential future.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/06/17/nyc-now/">NYC Now</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-17T15:47:00-06:00" pubdate data-updated="true">Jun 17<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/06/17/nyc-now/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This weekend I went to <a href="http://hacknjill.com/">hackn&#8217;jill</a>. I made <a href="http://nyc-now.appspot.com/">NYC Now</a>, a web app to find something to do right now. It shows a map with events around it. It can detect your location or you can set one by clicking. Ajax updates via json. Events and map markers highlight or animate on hover of the corresponding item. It is quickly filterable (easy to remove things you don&#8217;t want to see), so something can be found fast. Code <a href="https://github.com/mjibson/nycnow">is available on github</a>. BSD license.</p>

<p>Although the idea was one of the simpler at the hackathon (aggregation of some events APIs + a map), I think the implementation and interface are quick and pleasant enough to make it a pleasure to use. It is fast and unobtrusive. I found myself browsing around it tonight, and found quite a few things I will actually go do at some point (which I would have not found before).</p>

<p>Things I learned:</p>

<ul>
<li>async app engine url fetch</li>
<li>html5 url rewriting</li>
<li>html5 location fetching</li>
<li>more jquery</li>
<li>I still think app engine is the best web platform around</li>
</ul>


<p>It is powered by:</p>

<ul>
<li>google app engine</li>
<li>python</li>
<li>jquery</li>
<li>foursquare</li>
<li>yipit</li>
<li><a href="https://nycopendata.socrata.com/">nyc.gov open data</a></li>
<li><a href="http://developer.nytimes.com/docs/events_api">New York Times Events API</a></li>
</ul>


<p>It has no:</p>

<ul>
<li>social media connections</li>
<li>users or registration</li>
<li>database</li>
<li>cache</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/05/29/re2net-part-2-dfa/">re2net - part 2: DFA</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-05-29T15:54:00-06:00" pubdate data-updated="true">May 29<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/05/29/re2net-part-2-dfa/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have <a href="https://github.com/mjibson/re2net/commit/4f5f274fb6299c703d70541af795918371f0bdd6">added</a> a DFA state machine to the re2net library, as described <a href="http://swtch.com/~rsc/regexp/regexp1.html">here</a>. This method computes the DFA states on demand, which makes subsequent matches with the same instance faster. The crude benchmark below shows run times for the NFA (as in <a href="http://blog.mattjibson.com/2012/05/re2net---C-RE2-implementation-part-1">part 1</a>), DFA&#8217;s first run, DFA&#8217;s second run, and C#&#8217;s Regex library as a comparison.</p>

<p>The results below show that the DFA is about an order of magnitude slower than the NFA on the first run (as expected, since the cache is being computed), but an order of magnitude faster on the second run (since the cache is being used).</p>

<p>Until now, this has been an academic exercise to learn C# and build a simple regex parser. With that done, the next step is to support the full regex syntax. The <a href="http://code.google.com/p/re2/">RE2</a> library is this project, but I&#8217;m going to use <a href="http://code.google.com/p/go/source/browse/#hg%2Fsrc%2Fpkg%2Fregexp">Go&#8217;s regexp package</a> since I think the code will be easier to read, and it&#8217;s the same implementation. This is all assuming I maintain interest.</p>

<p>Column headers, all times in seconds.</p>

<p>n, NFA, DFA, DFA2, C# Regex:</p>

<pre>
01: 0.0046062, 0.0025143, 0.0000043, 00.0000278
02: 0.0000148, 0.0000108, 0.0000024, 00.0000040
03: 0.0000222, 0.0000231, 0.0000034, 00.0000034
04: 0.0000145, 0.0000216, 0.0000077, 00.0000021
05: 0.0000170, 0.0000355, 0.0000049, 00.0000030
06: 0.0000213, 0.0000476, 0.0000102, 00.0000052
07: 0.0000334, 0.0000742, 0.0000064, 00.0000092
08: 0.0000395, 0.0000971, 0.0000077, 00.0000176
09: 0.0000504, 0.0001212, 0.0000080, 00.0000346
10: 0.0000621, 0.0001552, 0.0000086, 00.0000702
11: 0.0000766, 0.0001821, 0.0000086, 00.0001184
12: 0.0000899, 0.0008207, 0.0000092, 00.0002622
13: 0.0001011, 0.0002600, 0.0000092, 00.0004787
14: 0.0001178, 0.0003105, 0.0000111, 00.0010533
15: 0.0001252, 0.0003729, 0.0000120, 00.0020185
16: 0.0001759, 0.0004468, 0.0000160, 00.0041630
17: 0.0001945, 0.0004914, 0.0000120, 00.0088549
18: 0.0002310, 0.0005789, 0.0000157, 00.0160122
19: 0.0002409, 0.0007215, 0.0000139, 00.0318414
20: 0.0003145, 0.0008251, 0.0000170, 00.0634503
21: 0.0003732, 0.0009216, 0.0000148, 00.1416363
22: 0.0004308, 0.0009741, 0.0000185, 00.2809800
23: 0.0004156, 0.0010700, 0.0000160, 00.5715502
24: 0.0004849, 0.0011817, 0.0000204, 01.1391405
25: 0.0005489, 0.0017962, 0.0000216, 02.2826699
26: 0.0005520, 0.0014535, 0.0000228, 04.5484486
27: 0.0010332, 0.0016941, 0.0000213, 09.0551722
28: 0.0010230, 0.0018286, 0.0000216, 18.4857312
29: 0.0010944, 0.0019780, 0.0000207, 37.1557184
</pre>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
	<h1><a href="/about">About Matt</a></h1>
	<p><b>Matt Jibson</b> works at <a href="http://stackexchange.com/">Stack Exchange</a> on <a href="http://careers.stackoverflow.com/">Careers 2.0</a>. I play piano and pipe organ.
	</p>
	<p>I&#8217;m on <a href="https://github.com/mjibson">GitHub</a> and <a href="https://twitter.com/mjibson">Twitter</a>.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/03/01/careers-localization-part-3-extraction/">Careers Localization, part 3: Extraction with Roslyn and Uglify</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/28/careers-localization-part-2-api/">Careers Localization, part 2: The API</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/27/careers-localization-part-1-why-roll-our-own/">Careers Localization, part 1: Why Roll Our Own?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/05/appstats-for-go/">Appstats for Go</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/10/job-offers-are-not-demands/">Job offers are not demands</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("mjibson", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/mjibson" class="twitter-follow-button" data-show-count="false">Follow @mjibson</a>
  
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Matt Jibson -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mjibson-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
